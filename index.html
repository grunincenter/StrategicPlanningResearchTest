<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Strategic Planning Research Version 2 - Comparative Analysis</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/SVSLyojsvWv9Ue8ExI="
        crossorigin=""/>
        <style>
        /* --- General and Layout Styles --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Helvetica Neue', sans-serif;
            background: #f5f5f5;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 30px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid #00abce;
            padding-bottom: 20px;
        }

        .header h1 {
            color: #330662;
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            color: #330662;
            font-size: 20px;
            font-weight: normal;
        }

        /* --- View Controls (Tabs) --- */
        .view-controls {
            display: flex;
            justify-content: center;
            align-items: baseline;
            gap: 10px;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #f9f9f9 0%, #f0f0f0 100%);
            border-radius: 8px;
            flex-wrap: wrap;
        }

        .view-header {
            color: #999;
            font-size: 14px;
            font-weight: 500;
            position: relative;
            padding: 8px 10px;
            cursor: pointer; 
            transition: all 0.3s;
            white-space: nowrap;
        }

        .view-header:hover:not(.active) {
            color: #666;
        }

        .view-header.active {
            color: #330662;
            font-size: 16px;
            font-weight: 700;
            padding: 10px 15px;
            background: white;
            border-radius: 5px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-left: 4px solid #702b9d;
            cursor: default;
        }

        .view-header:not(.active)::after {
            content: '|';
            position: absolute;
            right: -8px;
            color: #ddd;
        }

        .view-header:last-child::after {
            display: none;
        }

        .view-container {
            min-height: 500px;
        }

        .view-panel {
            display: none;
            padding-top: 20px;
        }

        .view-panel.active {
            display: block;
        }
        
        /* --- Dynamic Loading & Error State --- */
        .loading {
            text-align: center;
            padding: 50px;
            font-size: 18px;
            color: #702b9d;
        }
        
        .error {
            text-align: center;
            padding: 50px;
            font-size: 18px;
            color: #cc3300;
            background: #ffebeb;
            border: 1px solid #cc3300;
            border-radius: 5px;
        }


        /* --- Executive Summary Styles --- */
        .executive-summary {
            max-width: 1000px;
            margin: 0 auto;
        }

        .summary-intro {
            background: linear-gradient(135deg, #330662 0%, #702b9d 100%);
            color: white;
            padding: 30px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        .summary-intro h2 {
            font-size: 24px;
            margin-bottom: 15px;
        }

        .summary-intro p {
            font-size: 16px;
            line-height: 1.6;
            opacity: 0.95;
            margin-bottom: 15px;
        }

        .metrics-bar {
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #f9f9f9 0%, #e8f4f8 100%);
            border-radius: 8px;
            flex-wrap: wrap;
            gap: 20px;
            border: 1px solid #00abce;
        }

        .metric {
            text-align: center;
            flex: 1;
            min-width: 120px;
        }

        .metric-value {
            font-size: 32px;
            font-weight: bold;
            color: #330662;
        }

        .metric-label {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }

        /* --- Table/Card Styles (for all dynamic tabs) --- */
        .data-table-container, .card-gallery {
            overflow-x: auto;
            margin-bottom: 30px; 
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        .data-table th, .data-table td {
            padding: 10px 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        .data-table th {
            background: #702b9d;
            color: white;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 12px;
            border-bottom: 3px solid #330662;
            position: sticky;
            top: 0;
            white-space: nowrap;
            vertical-align: top; 
        }
        
        /* FIX: Style for the dynamically inserted tier headers in the shortlist table */
        .data-table .commitment-header th {
            background: #9d7cc4 !important; /* Lighter purple */
            text-align: center;
            position: static; /* Prevent tier headers from sticking with the main header */
        }
        /* Style for the checkmark/cross cells */
        .data-table .yes-cell { color: #00abce; font-weight: bold; }
        .data-table .no-cell { color: #ccc; }


        /* --- Field Strength Dot Indicators --- */
        .strength-indicator {
            display: flex;
            gap: 3px;
            justify-content: center;
        }
        .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            border: 1px solid #ccc;
            opacity: 0.3;
        }
        .dot.filled {
            border: none;
            opacity: 1;
        }
        .dot.se-dot { background-color: #702b9d; } /* Purple */
        .dot.ii-dot { background-color: #00abce; } /* Teal */
        .dot.sd-dot { background-color: #FFD700; } /* Gold */
        
        /* --- Card Gallery (for Centers, Clinics, Events, Stories) --- */
        .card-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            padding: 10px 0;
        }

        .data-card {
            background: #fdfdfd;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 1px 5px rgba(0,0,0,0.05);
            transition: transform 0.2s;
            position: relative;
        }

        .data-card.highlight {
            border: 2px solid #702b9d;
            box-shadow: 0 4px 12px rgba(112, 43, 157, 0.2);
        }

        .card-title {
            font-size: 18px;
            color: #330662;
            margin-bottom: 5px;
            border-bottom: 1px solid #e8e8e8;
            padding-bottom: 5px;
        }

        .card-subtitle {
            font-size: 14px;
            color: #00abce;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .card-description {
            font-size: 14px;
            color: #555;
            margin-bottom: 15px;
        }
        
        .card-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 10px;
        }
        
        .badge {
            font-size: 10px;
            padding: 4px 8px;
            border-radius: 12px;
            color: white;
            font-weight: bold;
            text-transform: uppercase;
        }
        
        .tier-badge { background-color: #702b9d; }
        .category-badge { background-color: #333; }

        .card-footer {
            border-top: 1px solid #f0f0f0;
            padding-top: 10px;
            font-size: 12px;
            color: #999;
        }
        
        .card-footer a {
            color: #00abce;
            text-decoration: none;
            font-weight: 600;
        }

        /* --- Footer and Modal (Retained) --- */
        .footer-note {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
            text-align: center;
            font-size: 11px;
            color: #999;
            font-style: italic;
        }
        .modal {
            display: none; 
            position: fixed; 
            z-index: 10;
            left: 0;
            top: 0;
            width: 100%; 
            height: 100%; 
            overflow: auto; 
            background-color: rgba(0,0,0,0.4); 
            padding-top: 60px;
        }

        .modal-content {
            background-color: #fefefe;
            margin: 5% auto; 
            padding: 20px;
            border: 1px solid #888;
            width: 80%; 
            max-width: 600px;
            border-radius: 8px;
            position: relative;
        }

        .close-btn {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close-btn:hover,
        .close-btn:focus {
            color: #000;
            text-decoration: none;
            cursor: pointer;
        }
        #mapid {
            height: 500px;
            width: 100%;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Strategic Planning Research Version 2</h1>
            <p>Comparative U.S. Law School Programmatic Analysis</p>
        </div>

        <div class="view-controls">
            <div class="view-header" onclick="showView('summary')">Executive Summary</div>
            <div class="view-header" onclick="showView('shortlist')">Short List</div>
            <div class="view-header" onclick="showView('map')">Map</div>
            <div class="view-header" onclick="showView('centers')">Institutes, Centers & Programs</div>
            <div class="view-header" onclick="showView('clinics')">Clinics</div>
            <div class="view-header" onclick="showView('events')">Events</div>
            <div class="view-header" onclick="showView('stories')">Stories & Emerging Programs</div>
        </div>

        <div class="view-container">
            <div id="loading-view" class="view-panel active loading">
                <p>Loading data from /data/ files...</p>
            </div>
            
            <div id="error-view" class="view-panel error" style="display: none;">
                <h2>Data Loading Error</h2>
                <p>Could not load all required CSV files. Please ensure the `/data/` folder exists and contains all five files (`schools.csv`, `centers.csv`, `clinics.csv`, `events.csv`, `stories.csv`).</p>
                <p>Check the browser console for specific errors (e.g., file not found).</p>
            </div>

            <div id="summary-view" class="view-panel">
                <div class="executive-summary">
                    

                    <div class="metrics-bar">
                        <div class="metric">
                            <div class="metric-value" id="total-schools">...</div>
                            <div class="metric-label">TOTAL SCHOOLS (From schools.csv)</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="strong-count">...</div>
                            <div class="metric-label">SCHOOLS WITH STRONG COMMITMENT</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="total-centers">...</div>
                            <div class="metric-label">TOTAL CENTERS/INSTITUTES FOUND</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="total-clinics">...</div>
                            <div class="metric-label">TOTAL CLINICS FOUND</div>
                        </div>
                    </div>
               <p class="blurb-text">
    This section provides a high-level summary of the research methodology, key strategic criteria, and the resulting list of law schools identified for potential deep-dive engagement.
    
    <br><br>
    
    **Our Process:** The analysis began by pulling a list of **all 199 ABA-accredited law schools**. We conducted an initial extensive search of all 199 websites, using keywords and **GPT prompts** to identify schools with new programming in **social entrepreneurship**, **impact investing**, and **sustainable development**. Following this initial sweep, we redefined the school categories (strong, substantial, and some commitment) to be based **solely on the nature and depth of their institutional commitment** to the core topics, explicitly excluding US News law school rankings as a factor. The final shortlist was then rigorously categorized after **manually visiting and combing the websites** of each law school, center, and clinic to capture any programming, events, or extracurriculars that were not included in our initial research.
    
    <br><br>
    
    Use this section to examine the core findings presented across the dashboard and to frame the comparative analysis of the final short list.
</p>

            <div id="shortlist-view" class="view-panel">
                <h2>Short List: Institutional Commitment Matrix</h2>
                <p style="margin-bottom: 20px; color: #666; font-size: 15px;">Matrix view of schools with demonstrated institutional commitment, organized by tier. Displays tier badge, field strength dots (SE/II/SD), and offering checkmarks.</p>
                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr id="shortlist-table-header">
                                <th style="width: 250px;">School</th>
                                <th>SE (Social Ent.)</th>
                                <th>II (Impact Inv.)</th>
                                <th>SD (Sust. Dev.)</th>
                                <th>Has Center</th>
                                <th>Has Clinic</th>
                                <th>Has Events</th>
                                <th>Partnership</th>
                            </tr>
                        </thead>
                        <tbody id="shortlist-table-body">
                            <tr><td colspan="8">Data loading...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

        <div id="map-view" class="view-panel">
                <h2>Map: Geographic Visualization</h2>
                <p style="margin-bottom: 20px; color: #666; font-size: 15px;">Map will show the location of all schools with relevant activity...</p>
                
                                <div id="mapid"></div>
                
            </div>

            <div id="centers-view" class="view-panel">
                <h2>Institutes, Centers & Programs</h2>
                <p style="margin-bottom: 20px; color: #666; font-size: 15px;">Card-based display of all centers/institutes with relevant programming. NYU appears first; short list schools highlighted in purple; all other schools shown in gray.</p>
                <div class="card-gallery" id="centers-card-gallery">
                    <p>Waiting for data from `centers.csv`...</p>
                </div>
            </div>

            <div id="clinics-view" class="view-panel">
                <h2>Clinics</h2>
                <p style="margin-bottom: 20px; color: #666; font-size: 15px;">Card-based display for clinics serving social entrepreneurs, impact investors, or sustainable development clients. Filterable by short list vs. all schools.</p>
                <div class="card-gallery" id="clinics-card-gallery">
                    <p>Waiting for data from `clinics.csv`...</p>
                </div>
            </div>

            <div id="events-view" class="view-panel">
                <h2>Symposia, Conferences, and Recurring Events</h2>
                <p style="margin-bottom: 20px; color: #666; font-size: 15px;">Shows event name, type, whether recurring or one-time, field strength, and last held date. Useful for tracking field activity and partnership opportunities.</p>
                <div class="card-gallery" id="events-card-gallery">
                    <p>Waiting for data from `events.csv`...</p>
                </div>
            </div>

            <div id="stories-view" class="view-panel">
                <h2>Stories & Emerging Programs</h2>
                <p style="margin-bottom: 20px; color: #666; font-size: 15px;">Qualitative card gallery for items that don't fit neatly into other categories: new programs, one-off events, and notable details.</p>
                <div class="card-gallery" id="stories-card-gallery">
                    <p>Waiting for data from `stories.csv`...</p>
                </div>
            </div>
            
        </div>
        
        <div class="footer-note">
            Data loaded dynamically from CSV files in the /data/ folder. Data verification date will be reflected in the source files.
        </div>

    </div> 
    
    <div id="school-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <h2 id="modal-title" style="color: #330662; border-bottom: 2px solid #00abce; padding-bottom: 10px;">School Details</h2>
            <div id="modal-content" style="margin-top: 15px;">
                <p>This modal will display detailed information when a school name is clicked.</p>
            </div>
        </div>
    </div>

    <script>
        // Data storage object for all loaded CSV data
        const data = {
            schools: [],
            centers: [],
            clinics: [],
            events: [],
            stories: []
        };
        
        // CSV Paths
        const csvPaths = {
            schools: './data/schools.csv',
            centers: './data/centers.csv',
            clinics: './data/clinics.csv',
            events: './data/events.csv',
            stories: './data/stories.csv'
        };

        // Utility function to parse CSV text into an array of objects
        function parseCSV(csvText) {
            const lines = csvText.trim().split('\n');
            if (lines.length === 0) return [];
            
            // NOTE: Simple split(',') is used here but may fail if data contains escaped commas.
            // For production, a robust CSV library (like PapaParse) is recommended.
            const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));
            const result = [];
            
            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',');
                if (values.length !== headers.length) continue; 

                const row = {};
                headers.forEach((header, index) => {
                    // Trim and handle boolean/numeric values
                    let value = values[index].trim().replace(/"/g, ''); // Remove quotes too
                    if (value.toLowerCase() === 'true') value = true;
                    else if (value.toLowerCase() === 'false') value = false;
                    else if (!isNaN(value) && value !== '') value = Number(value);
                    
                    row[header] = value;
                });
                result.push(row);
            }
            return result;
        }

        // Main data loading function (fetches all CSVs concurrently)
        async function loadData() {
            try {
                const fetchPromises = Object.keys(csvPaths).map(key => 
                    fetch(csvPaths[key]).then(response => {
                        if (!response.ok) {
                            throw new Error(`Failed to load ${csvPaths[key]}: ${response.statusText}`);
                        }
                        return response.text();
                    }).then(csvText => {
                        data[key] = parseCSV(csvText);
                    })
                );

                await Promise.all(fetchPromises);
                
                // Data loaded successfully
                document.getElementById('loading-view').style.display = 'none';
                initializeDashboard();

            } catch (error) {
                console.error("Dashboard Data Loading Error:", error);
                document.getElementById('loading-view').style.display = 'none';
                document.getElementById('error-view').style.display = 'block';
            }
        }
        
        // Helper function to generate field strength dots (0-3)
        function generateStrengthDots(strength, field) {
            let html = '<div class="strength-indicator">';
            const colorClass = field === 'se' ? 'se-dot' : field === 'ii' ? 'ii-dot' : 'sd-dot';
            for (let i = 1; i <= 3; i++) {
                const isFilled = i <= strength;
                html += `<div class="dot ${colorClass} ${isFilled ? 'filled' : ''}"></div>`;
            }
            html += '</div>';
            return html;
        }

        function renderShortList() {
            const tbody = document.getElementById('shortlist-table-body');
            let html = '';
            
            // Filter out schools without a tier, then group by tier
            const tieredSchools = data.schools.filter(s => s.tier);

            const schoolsByTier = tieredSchools.reduce((acc, school) => {
                if (!acc[school.tier]) acc[school.tier] = [];
                acc[school.tier].push(school);
                return acc;
            }, {});
            
            const tierOrder = ['Strong Institutional Commitment', 'Substantial Institutional Commitment', 'Some Institutional Commitment'];
            
            tierOrder.forEach(tier => {
                if (schoolsByTier[tier]) {
                    html += `
                        <tr class="commitment-header">
                            <th colspan="8">${tier}*</th>
                        </tr>
                    `;
                    
                    schoolsByTier[tier].sort((a, b) => a.school_name.localeCompare(b.school_name)).forEach(school => {
                        const hasCenter = school.has_center ? '<span class="yes-cell">X</span>' : '<span class="no-cell">-</span>';
                        const hasClinic = school.has_clinic ? '<span class="yes-cell">X</span>' : '<span class="no-cell">-</span>';
                        const hasEvents = school.has_events ? '<span class="yes-cell">X</span>' : '<span class="no-cell">-</span>';
                        const hasPartnership = school.has_partnership ? `<span class="yes-cell" title="${school.partnership_note}">X</span>` : '<span class="no-cell">-</span>';
                        
                        // NYU (school_id = 1) is always first in its tier
                        const nameCell = school.school_id === 1 
                            ? `<span class="school-name" style="color: #702b9d;">${school.school_name} (Benchmark)</span>`
                            : `<span class="school-name" onclick="showSchoolDetails(${school.school_id})" style="cursor: pointer; text-decoration: underline;">${school.school_name}</span>`;

                        html += `
                            <tr>
                                <td>${nameCell}</td>
                                <td>${generateStrengthDots(school.se_strength, 'se')}</td>
                                <td>${generateStrengthDots(school.ii_strength, 'ii')}</td>
                                <td>${generateStrengthDots(school.sd_strength, 'sd')}</td>
                                <td style="text-align: center;">${hasCenter}</td>
                                <td style="text-align: center;">${hasClinic}</td>
                                <td style="text-align: center;">${hasEvents}</td>
                                <td style="text-align: center;">${hasPartnership}</td>
                            </tr>
                        `;
                    });
                }
            });

            tbody.innerHTML = html || '<tr><td colspan="8">No school data available. Please check schools.csv.</td></tr>';
        }
        
        function renderProgramCards(dataArray, containerId, highlightCondition) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            let html = '';
            
            if (dataArray.length === 0) {
                container.innerHTML = '<p>No data available. Please populate the relevant CSV file.</p>';
                return;
            }

            // Ensure NYU's program (if applicable) is first
            const sortedData = dataArray.sort((a, b) => {
                if (a.school_id === 1) return -1;
                if (b.school_id === 1) return 1;
                return 0;
            });

            sortedData.forEach(item => {
                const school = data.schools.find(s => s.school_id === item.school_id) || { school_name: 'Unknown School', tier: 'N/A' };
                const isHighlight = highlightCondition(school, item);
                const highlightClass = isHighlight ? 'highlight' : '';

                const fieldStrengthHtml = `
                    <div class="card-badges" style="margin-top: 5px; justify-content: flex-start;">
                        <div class="badge tier-badge">${school.tier}</div>
                    </div>
                    <p style="font-size: 11px; margin-top: 5px;">
                        SE: ${generateStrengthDots(item.se_strength, 'se')} &nbsp;&nbsp;
                        II: ${generateStrengthDots(item.ii_strength, 'ii')} &nbsp;&nbsp;
                        SD: ${generateStrengthDots(item.sd_strength, 'sd')}
                    </p>
                `;

                // Common card structure for centers, clinics, and events
                html += `
                    <div class="data-card ${highlightClass}">
                        <h4 class="card-title">${item.name}</h4>
                        <div class="card-subtitle">${school.school_name}</div>
                        <p class="card-description">${item.description || 'No description provided.'}</p>
                        ${fieldStrengthHtml}
                        <div class="card-footer">
                            ${item.year_founded ? `Founded: ${item.year_founded}` : item.last_held ? `Last Held: ${item.last_held}` : ''}
                            ${item.url ? ` | <a href="${item.url}" target="_blank">External Link</a>` : ''}
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }
        
        function renderStories() {
            const container = document.getElementById('stories-card-gallery');
            if (!container) return;

            if (data.stories.length === 0) {
                container.innerHTML = '<p>No data available. Please populate stories.csv.</p>';
                return;
            }
            
            let html = '';
            
            data.stories.forEach(story => {
                const school = data.schools.find(s => s.school_id === story.school_id) || { school_name: 'Unknown School', tier: 'N/A' };
                
                const fieldTags = [
                    story.se_tag ? `<span class="badge" style="background-color: #702b9d;">SE</span>` : '',
                    story.ii_tag ? `<span class="badge" style="background-color: #00abce;">II</span>` : '',
                    story.sd_tag ? `<span class="badge" style="background-color: #FFD700; color: #333;">SD</span>` : ''
                ].join(' ');

                html += `
                    <div class="data-card">
                        <h4 class="card-title">${story.headline}</h4>
                        <div class="card-subtitle">${school.school_name}</div>
                        
                        <div class="card-badges">
                            <span class="badge category-badge" style="background-color: #555;">${story.category}</span>
                            ${fieldTags}
                        </div>
                        
                        <p class="card-description">${story.description || 'No description provided.'}</p>
                        
                        <div class="card-footer">
                            Follow-up: ${story.follow_up_note || 'N/A'}
                            ${story.url ? ` | <a href="${story.url}" target="_blank">Source</a>` : ''}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function initializeDashboard() {
            // 1. Render all dynamic content
            renderExecutiveSummary();
            renderShortList();
            
            // Highlight NYU and any schools with 'Strong Institutional Commitment'
            const highlightSchools = (school) => school.school_id === 1 || school.tier === 'Strong Institutional Commitment';

            renderProgramCards(data.centers, 'centers-card-gallery', highlightSchools);
            renderProgramCards(data.clinics, 'clinics-card-gallery', highlightSchools);
            renderProgramCards(data.events, 'events-card-gallery', highlightSchools);
            renderStories();

            // 2. Set the initial view (Summary)
            showView('summary'); 
        }

        // --- CORE NAVIGATION/MODAL FUNCTIONS ---

        /**
         * CORE FUNCTION: Toggles the active view and updates the header tabs.
         */
        function showView(viewId) {
            // Hide all view panels
            document.querySelectorAll('.view-panel').forEach(panel => {
                panel.classList.remove('active');
                panel.style.display = 'none';
            });

            // Deactivate all view headers
            document.querySelectorAll('.view-header').forEach(header => {
                header.classList.remove('active');
            });

            // Show the requested view panel
            const targetPanel = document.getElementById(viewId + '-view');
            if (targetPanel) {
                targetPanel.classList.add('active');
                targetPanel.style.display = 'block';
            }

            // Activate the corresponding header (FIXED: The logic to find and activate the header)
            const targetHeader = document.querySelector(`.view-header[onclick*="showView('${viewId}')"]`);
            if (targetHeader) {
                targetHeader.classList.add('active');
            }
        } // <--- This closing brace was missing!


        /**
         * MODAL FUNCTION: Displays the details for a specific school.
         */
        function showSchoolDetails(schoolId) {
            const school = data.schools.find(s => s.school_id === schoolId);

            if (!school) {
                console.error("School not found:", schoolId);
                return;
            }

            document.getElementById('modal-title').textContent = school.school_name;
            document.getElementById('modal-content').innerHTML = `
                <p><strong>Tier:</strong> ${school.tier}</p>
                <p><strong>Ranking:</strong> ${school.ranking || 'N/A'}</p>
                <p style="margin-top: 15px;"><strong>Commitment Details:</strong></p>
                <ul>
                    <li>Social Entrepreneurship Strength: ${generateStrengthDots(school.se_strength, 'se')}</li>
                    <li>Impact Investing Strength: ${generateStrengthDots(school.ii_strength, 'ii')}</li>
                    <li>Sustainable Development Strength: ${generateStrengthDots(school.sd_strength, 'sd')}</li>
                </ul>
                <p style="margin-top: 15px;">**Full programmatic data (centers, clinics, etc.) for this school would be dynamically loaded here in a fully functional dashboard.**</p>
                <p style="font-size: 12px; color: #999; margin-top: 10px;">Note: This detail is a placeholder summary.</p>
            `;

            document.getElementById('school-modal').style.display = 'block';
        }


        /**
         * MODAL FUNCTION: Hides the school details modal.
         */
        function closeModal() {
            document.getElementById('school-modal').style.display = 'none';
        }

        // Initializer
        document.addEventListener('DOMContentLoaded', loadData);

    </script>
</body>
</html>





